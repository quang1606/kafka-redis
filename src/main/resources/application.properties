# ===============================
# 1. THÔNG TIN SERVER
# ===============================
server.port=8081
spring.application.name=kafkaredis-service

# ===============================
# 2. C?U HÌNH DATABASE (POSTGRESQL)
# ===============================
# N?u ch?y ? máy th?t, nó dùng localhost. N?u ch?y Docker, nó dùng bi?n môi tr??ng SPRING_DATASOURCE_URL
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/kafkaredis_db}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:admin}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:password123}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# ===============================
# 3. C?U HÌNH REDIS
# ===============================
spring.data.redis.host=${SPRING_DATA_REDIS_HOST:localhost}
spring.data.redis.port=${SPRING_DATA_REDIS_PORT:6379}
# N?u Redis có m?t kh?u thì ?i?n vào ?ây (m?c ??nh Docker c?a b?n không ?? pass)
# spring.data.redis.password=

# ===============================
# 4. C?U HÌNH KAFKA
# ===============================
# ??a ch? server Kafka
#spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
#
## Consumer config
#spring.kafka.consumer.group-id=kafkaredis-group
#spring.kafka.consumer.auto-offset-reset=earliest
#spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
#spring.kafka.consumer.value-deserializer=org.apache.kafka.common.serialization.StringDeserializer
#
## Producer config
#spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
#spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer
# 4. C?U HÌNH KAFKA (?Ã C?P NH?T CHO JSON)
# ===============================
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}

# Producer config: G?i Object t? ??ng bi?n thành JSON
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer

# Consumer config: Nh?n JSON t? ??ng bi?n thành Object
spring.kafka.consumer.group-id=view_log_group
spring.kafka.consumer.auto-offset-reset=earliest
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
# S? d?ng ErrorHandlingDeserializer ?? tránh ch?t Consumer n?u nh?n d? li?u sai format
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

# C?u hình chi ti?t cho vi?c gi?i mã JSON
spring.kafka.consumer.properties.spring.deserializer.value.delegate.class=org.springframework.kafka.support.serializer.JsonDeserializer
# Quan tr?ng: Cho phép Kafka tin t??ng package ch?a DTO c?a b?n
spring.kafka.consumer.properties.spring.json.trusted.packages=com.example.kafkaredis.dto.respose
# ===============================
# 5. C?U HÌNH LOGGING & JSON
# ===============================
# Format th?i gian cho JSON tr? v? API
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Asia/Ho_Chi_Minh

# Logging m?c ?? DEBUG ?? xem SQL và l?i d? h?n (khi ch?y th?t nên ?? INFO)
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG